---
title: "p8105_hw5_cev2129"
output: html_document
date: "2024-11-14"
---

```{r}
library(tidyverse)
library(rvest)
set.seed(1)
``` 

##Problem 2

```{r}
q2_t_test = function(mu, iterations = 5000) { 
  replicate(iterations, {
    data <- rnorm(n = 30, mean = mu, sd = 5)
    t_test <- t.test(data, mu = 0) 
    broom::tidy(t_test)  
  }, simplify = FALSE) |>
    bind_rows() |>
    mutate(mu = mu)
}

values = c(0, 1, 2, 3, 4, 5, 6) 

q2_results = map_dfr(values, q2_t_test) 

q2_power = q2_results |>
  group_by(mu) |>
  summarize(
    mean_estimate = mean(estimate),
    power = mean(p.value < 0.05)
  )

q2_power
```

```{r}
library(ggplot2)
ggplot(q2_power, aes(x = mu, y = power)) + 
  geom_point()
```

```{r}

```


